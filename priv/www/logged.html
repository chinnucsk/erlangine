<span id=loggedUid></span>
<a id=logoutNow class=hint>(logout)</a>

<script>

function logOut(){
    var json = {
	    "module": "login",
	    "action": "logout"
    }
    ajax(json, "/enge");
};

function cbAlreadyLogged(json){
    $('loggedUid').innerHTML = "<a href=#>" + json.reply.uid + "@" + json.reply.domain + "</a>";
    showElement('loggedContainer');
    hideElement('welcomePage');
    showElement('mainDesk');
}

function cbLoggedOut(json){
    loggedOut();
}

function loggedOut(){
    hideElement('loggedContainer');
    showElement('loginContainer');
    hideElement('mainDesk');
    showElement('welcomePage');
    // XXX reload page to hide old user's data in hidden divs
}

connect('logoutNow', 'onclick', logOut);

connect(xapi, 'login:check-ok', cbAlreadyLogged);
connect(xapi, 'login:logout-ok', cbLoggedOut);
</script>
